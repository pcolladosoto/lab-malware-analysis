# Makefile for handling the compilation of ASM programs.

ASSEMBLER = nasm
LINKER = gcc

FNAMES = hello_world print_data print_data_short
SRCS = $(addsuffix .asm, $(FNAMES))
PROGS = $(addsuffix .ex, $(FNAMES))

TRASH = *.o *.ex

all: $(PROGS)

hello_world.ex: hello_world.o
	$(LINKER) -o $@ $< $(CFLAGS)

print_data.ex: print_data.o
	$(LINKER) -o $@ $< $(CFLAGS)

print_data_short.ex: print_data_short.o
	$(LINKER) -o $@ $< $(CFLAGS)

%.o: %.asm
	$(ASSEMBLER) -g -f elf64 -o $@ $<

.PHONY: clean respect_specs

clean:
	rm -f $(TRASH)

respect_specs:
	$(foreach file, $(SRCS), ./tidy_up.sh $(file))
